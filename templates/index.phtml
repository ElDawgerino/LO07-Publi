<html>
    <head>
        <meta charset="utf-8"/>
        <title>LO07-publi</title>
        <script src="public/libs/angular.min.js"></script>
        <script src="public/libs/angular-ui-router.min.js"></script>
        <script src="public/libs/angular-base64-upload.js"></script>
        <script src="public/libs/sha256.js"></script>
        <script src="public/auth.js"></script>
        <script src="public/publi.js"></script>
        <script src="public/app.js"></script>
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="public/style.css">
    </head>
    <body ng-app="LO07-publi">
      <div id="contenu">
        <nav ng-controller="NavBar" class="nav">
        <ul>
          <li id="website-main-button"><i class="material-icons" style="vertical-align: middle;">archive</i> <button ng-click="goHome()">LO07-Publi</button></li>
          <li ng-show="loggedIn"><button ng-click="goPublish()">Publier</button></li>
          <li class="align-right" ng-show="loggedIn"><button ng-click="logout()">Déconnexion</button></li>
          <li class="align-right" ng-show="loggedIn"><button>{{username}}</button></li>
          <li class="align-right" ng-hide="loggedIn"><button ng-click="register()">Inscription</button></li>
          <li class="align-right" ng-hide="loggedIn"><button ng-click="login()">Connexion</button></li>
        </ul>
        </nav>

        <ui-view></ui-view>

        <script type="text/ng-template" id="home">
        <h1>LO07-publi</h1>
        <div ng-if='errors && errors != ""'>
            Echec de la connexion : {{errors}}
        </div>
        <p>Bienvenue sur le site de publications scientifiques.</p>
        <table ng-show="hasPublis">
          <tr>
            <th>Titre</th>
            <th>Description</th>
            <th>Statut</th>
            <th>Catégorie</th>
            <th>Année</th>
          </tr>
          <tr ng-repeat="publi in publis">
            <td><a href="#/publi/{{publi.id}}">{{publi.titre}}</a></td>
            <td>{{publi.description}}</td>
            <td>{{publi.statut}}</td>
            <td>{{publi.categorie}}</td>
            <td>{{publi.annee_publication}}</td>
          </tr>
        </table>
        <p ng-hide="hasPublis">Il n'y pour le moment aucune publication sur le site.</p>
        </script>

        <script type="text/ng-template" id="register">
        <h1>Inscription</h1>
        <div ng-if='errors && errors != ""'>
            Echec de la connexion : {{errors}}
        </div>
        <form>
          <label for="prenom">Prénom : </label>
          <input type="text" id="prenom" ng-model="user.prenom"> <br> <br>
          <label for="nom">Nom : </label>
          <input type="text" id="nom" ng-model="user.nom"> <br> <br>
          <label for="login">Identifiant : </label>
          <input type="text" id="login" ng-model="user.username"> <br> <br>
          <label for="password">Mot de passe : </label>
          <input type="password" id="password" ng-model="user.password"> <br> <br>
          <label for="organisation">Organisation : </label>
          <input type="text" id="organisation" ng-model="user.organisation"> <br> <br>
          <label for="equipe">Equipe : </label>
          <select id="equipe" ng-model="user.equipe" ng-options="equipe for equipe in equipes" ng-init="user.equipe = equipes[0]"></select> <br> <br>
          <button ng-click="register()">Inscription</button>
          <button ng-click="annuler()">Annuler</button>
        </form>
        </script>

        <script type="text/ng-template" id="login">
        <h1>Connexion</h1>
        <div ng-if='errors && errors != ""'>
            Echec de la connexion : {{errors}}
        </div>
        <form>
          <label for="login">Identifiant : </label>
          <input type="text" id="login" ng-model="login_info.username">
          <label for="password">Mot de passe :</label>
          <input type="password" id="password" ng-model="login_info.password">
          <button ng-click="login(login_info)">Connexion</button>
          <button ng-click="annuler()">Annuler</button>
        </form>
        </script>

        <script type="text/ng-template" id="publish">
        <h1>Publier</h1>
        <div ng-if='errors && errors != ""'>
            Echec de la connexion : {{errors}}
        </div>

        <form>
          <h3>Publication</h3>
          <label for="title">Titre : </label>
          <input type="text" id="title" ng-model="publi.titre" required><br>
          <label for="description">Description : </label>
          <textarea id="description" ng-model="publi.description" required></textarea><br>
          <label for="statut">Statut : </label>
          <select id="statut" ng-model="publi.statut"
            ng-options="statut for statut in statuts" ng-init="publi.statut = statuts[0]" required></select><br>
          <label for="categorie">Catégorie : </label>
          <select id="categorie" ng-model="publi.categorie"
            ng-options="categorie for categorie in categories" ng-init="publi.categorie = categories[0]"></select><br>
          <label for="annee">Année : </label>
          <input type="number" id="annee" ng-model="publi.annee_publication" ng-init="publi.annee_publication = 2010"><br><br>

          <h3>Auteur</h3>
          <label for="isAuteur">Je suis l'auteur de cette publication : </label>
          <input type="checkbox" id="isAuteur" ng-model="isAuteur"><br>
          <label for="auteur-prenom">Prenom : </label>
          <input type="text" id="auteur-prenom" ng-model="auteur.prenom"><br>
          <label for="auteur-nom">Nom : </label>
          <input type="text" id="auteur-nom" ng-model="auteur.nom"><br>
          <label for="auteur-organisation">Organisation : </label>
          <input type="text" id="auteur-organisation" ng-model="auteur.organisation"><br>
          <label for="auteur-equipe">Equipe : </label>
          <input type="text" id="auteur-equipe" ng-model="auteur.equipe"><br>
          <button type="button" ng-click="addAuteur()">Ajouter auteur</button>
          <ul>
            <li ng-repeat="auteur in publi.auteurs">
              {{auteur.prenom}} {{auteur.nom}} : {{auteur.organisation}}, {{auteur.equipe}}
              <button type="button" ng-click="removeAuteur($index)">Supprimer</button>
            </li>
          </ul>
          <br><br>

          <h3>Journal</h3>
          <label for="isJournal">La publication fait partie d'un journal : </label>
          <input type="checkbox" id="isJournal" ng-model="isJournal"><br ng-show="isJournal">
          <div ng-show="isJournal">
            <label for="journal_titre">Titre : </label>
            <input type="text" id="journal_titre" ng-model="publi.journal_titre"><br>
            <label for="journal_editeur">Editeur : </label>
            <input type="text" id="journal_editeur" ng-model="publi.journal_editeur"><br>
            <label for="journal_volume">Volume : </label>
            <input type="text" id="journal_volume" ng-model="publi.journal_volume"><br>
            <label for="pages">Pages : </label>
            <input type="text" id="pages" ng-model="publi.pages">
          </div>
          <br><br>

          <h3>Conférence</h3>
          <label for="isConf">La publication est liée à une conférence : </label>
          <input type="checkbox" id="isConf" ng-model="isConf">
          <div ng-show="isConf" ng-show="isConf">
            <br ng-show="isConf">
            <label for="conference_nom">Nom : </label>
            <input type="text" id="conference_nom" ng-model="publi.conference_nom"><br >
            <label for="conference_date">Date : </label>
            <input type="text" id="conference_date" ng-model="publi.conference_date"><br>
            <label for="conference_lieu">Lieu : </label>
            <input type="text" id="conference_lieu" ng-model="publi.conference_lieu"><br>
          </div>
          <br><br>

          <h3>Upload</h3>
          <label for="file">Fichier : </label>
          <input type='file' ng-model='publi.file' base-sixty-four-input required><br>
          <button ng-click="publish()">Publier</button>
        </form>
        </script>

        <script type="text/ng-template" id="publi">
          <h1>{{publi.titre}}</h1>
          <h3>Description : </h3>
          <p>{{publi.description}}</p>

          <h3>Informations : </h3>
          <p>Statut : {{publi.statut}}</p>
          <p>Catégorie : {{publi.categorie}}</p>
          <p>Année de publication : {{publi.annee_publication}}</p>

          <h3>Auteurs : </h3>
          <div ng-repeat="auteur in publi.auteurs">
            <p>Nom : {{auteur.nom}} {{auteur.nom | uppercase}}</p>
            <p>Organisation : {{auteur.organisation}}</p>
            <p>Equipe : {{auteur.equipe}}</p>
          </div>

          <div ng-show="hasJournal">
            <h3>Journal : </h3>
            <p>Titre : {{publi.journal_titre}}</p>
            <p>Editeur : {{publi.journal_editeur}}
            <p>Volume : {{publi.journal_volume}}</p>
            <p>Page(s) : {{publi.pages}}</p>
          </div>

          <div ng-show="hasConference">
            <h3>Conférence : </h3>
            <p>Nom : {{publi.conference_nom}}</p>
            <p>Lieu : {{publi.conference_lieu}}</p>
            <p>Date : {{publi.conference_date}}</p>
          </div>
        </script>

      </div>
      <footer>
        <p>Site web développé avec AngularJS et SlimPHP par Antoine Girard Guittard et Victor Levasseur.</p>
      </footer>
    </body>
</html>
